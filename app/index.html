<!DOCTYPE html>
<html charset='utf-8'>
    <head>
        <title>Setup</title>
        <link rel="stylesheet" href="style/menu.css" />
        <link href="https://fonts.googleapis.com/css?family=Raleway:400,600,700" rel="stylesheet">
        <link rel="stylesheet" href="style/game.css" />
        <link rel="stylesheet" href="tippy/tippy.css" />
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.7/angular.min.js"></script>
        <script src="https://use.fontawesome.com/a59db19925.js"></script>
        <script src="tippy/tippy.js"></script>
    </head>
    <body>
        <div class="container" 
            ng-app="app" 
            ng-controller="appController"
            ng-click="deactivateTooltip($event)">
            <div class="menu-container">
                <div class="board-options">
                    <h1>Choose board:</h1>
                    <div class="selection-array">
                        <div class="option-box" 
                            ng-click="menuOptionClick($event, opt)" 
                            ng-repeat="opt in allOptions">
                            <div class="img-box">
                                <img ng-src="{{ opt.image }}" />
                            </div>
                            <h2>{{ opt.text}}</h2>
                        </div>
                    </div>
                </div>
                <div class="final-setup">
                    <h1>Take a final look</h1>
                    <div class="menu-property-group" 
                        ng-repeat="group in groups">
                        <div class="left" 
                            ng-style="group.style" 
                            ng-click="leftClicked($event)">
                            <p class="remove-group" ng-click="groups.splice($index,1)">X</p>
                        </div>
                        <div class="all-properties">
                            <div class="property" ng-repeat="property in group.properties">
                                <input class="name" ng-model="property.name" />
                                <div class="value-div">
                                    <input class="value" ng-model="property.value" />
                                </div>
                                <div class="remove" ng-click="group.properties.splice($index,1)">X</div>
                            </div>
                            <button class="property" ng-click="addProp($index)">Add Property</but>
                        </div>
                        <input type="color" ng-model="group.style['background-color']" />
                    </div>
                    <button class="menu-property-group" ng-click="addPropGroup()">Add Property Group</button>
                    <h2>Settings</h2>
                    <div class="settings">
                        <div class="settings-box">
                            <p>Players</p>
                            <div class="input-div not-dollars">
                                <p>{{ players }}</p>
                                <!--<input type="range" min="2" max="10" class="settings-input" ng-model="players" />-->
                            </div>
                        </div>
                        <div class="settings-box">
                            <p>Accounting Fee</p>
                            <div class="input-div">
                                <input class="settings-input" ng-model="settings.accountingFee" />
                            </div>
                        </div>
                        <div class="settings-box">
                            <p>Company Purchase Fee</p>
                            <div class="input-div">
                                <input class="settings-input" ng-model="settings.companyPurchase" />
                            </div>
                        </div>
                        <div class="settings-box">
                            <p>Ownership Change Fee</p>
                            <div class="input-div">
                                <input class="settings-input" ng-model="settings.ownershipChange" />
                            </div>
                        </div>
                    </div>
                    <button class="start-button" ng-class="start()">Start</button>
                </div>
            </div>
            <div class="game">                    
                <div class="menu-bar">
                    <div class="bar-item">
                         <h4>{{players[currentPlayer].name}}</h4>
                    </div>
                    <div class="bar-item">
                        <h4>Buy Property <span class="fa">&#xf107;</span> </h4>
                        <div class="expanded-menu">
                            <div ng-repeat="group in groups">
                                <div ng-repeat="prop in group.properties 
                                    | filter:{'owned': false}" 
                                    ng-attr-style="border-left:.5em solid {{group.style['background-color']}}" 
                                    ng-click="addPropertyToPlayer(prop)">
                                    <div class="sub-bar-item"> {{ prop.name }}</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="buy-company bar-item" ng-click="addCompanyToPlayer()">
                        <h4>Buy Company</h4>
                    </div>
                    <div class="bar-item" ng-click="nextPlayer()">
                        <h4>Next Player</h4>
                    </div>
                </div>
                <div class="player-properties">
                    <div class="non-monopoly">
                        <ul>
                            <div class="non-monopoly-group" 
                                ng-repeat="group in players[currentPlayer].properties" 
                                ng-attr-style="border-left: 20px solid {{ groups[group.order].style['background-color'] }}" 
                                ng-class="groups[group.order].isReady ? 'ready' : ''"
                                ng-style="{'background-color': 
                                            {true: groups[group.order].style['background-color'].slice(0,-2) + '.5)',false:'transparent'}
                                            [groups[group.order].isReady == true]}"
                                ng-click="addMonopolyGroup(group)">
                                <li class="non-monopoly-prop" 
                                    ng-repeat="prop in group.properties 
                                    | orderBy: ['propInd']">
                                    {{groups[prop.groupInd].properties[prop.propInd].name}}
                                </li>
                            </div>
                        </ul>
                    </div>
                    <div class="monopoly-grid">
                        <canvas id="monopoly-canvas"></canvas>
                        <div class="company-positioning">
                            <div class="company-row">
                                <h3> {{ players[currentPlayer].name }} </h3>
                            </div>
                            <div class="company-row" 
                                ng-repeat="i in iterateOver(players[currentPlayer].maxLevel) track by $index" >
                                <div class="company" 
                                    ng-repeat="comp in players[currentPlayer].companies 
                                    | filter: {'level': ($index + 1)} "
                                    ng-click="activateCompany($event)">
                                    {{ comp.name }}
                                    <div class="tooltip">
                                        <div class="pointy"></div>
                                        <div class="message-container">
                                            <div class="message first active">
                                                <input ng-model="comp.name" />
                                                <button ng-click="severOwners($event)">Sever Owner</button>
                                                <button ng-click="addOwners($event)">Add Owner</button>
                                            </div>
                                            <div class="message sever">
                                                <button class="auto-width" ng-click="backTooltip($event)">Back</button>
                                                <h3>Sever Owner</h3>
                                                <div class="choose-all-companies">
                                                    <div class="company-decision" 
                                                        ng-repeat="owner in players[currentPlayer].companies 
                                                        | directlyOwns: comp | orderBy: owner.name"
                                                        ng-click="sever(owner, comp)">
                                                        {{ owner.name }}
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="message add">
                                                <button class="auto-width" ng-click="backTooltip($event)">Back</button>
                                                <h3>Choose Company</h3>
                                                <div class="choose-all-companies">
                                                    <div class="company-decision" 
                                                        ng-repeat="newOwner in players[currentPlayer].companies 
                                                        | notDirectlyOwnedBy: comp | doesNotOwn: comp | orderBy: subComp.name"
                                                        ng-click="addOwner(newOwner, comp)">
                                                        {{ newOwner.name }}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div></div>
                            <div class="player-monopolies company-row">
                                <div class="property-group" 
                                    ng-repeat="group in players[currentPlayer].monopolies">
                                    <div class="property" 
                                        ng-repeat="prop in group.properties | orderBy:['propInd']"
                                            ng-click="activateProperty($event)">
                                        <div class="property-holder"
                                            ng-attr-style="border-top: 1.5em solid {{groups[group.order].style['background-color'] }}">
                                            <h4 align="center"> {{ groups[prop.groupInd].properties[prop.propInd].short }} </h4>
                                        </div>
                                        <div class="tooltip top">
                                            <div class="message-container">
                                                <div class="message first active">
                                                    <h4>{{ groups[prop.groupInd].properties[prop.propInd].name }}</h4>
                                                    <button ng-click="severOwners($event)">Sever Owner</button>
                                                    <button ng-click="addOwners($event)">Add Owner</button>
                                                </div>
                                                <div class="message sever">
                                                    <button class="auto-width" ng-click="backTooltip($event)">Back</button>
                                                    <h3>Sever Owner</h3>
                                                    <div class="choose-all-companies">
                                                        <div class="company-decision" 
                                                            ng-repeat="owner in players[currentPlayer].companies 
                                                            | directlyOwns: comp | orderBy: owner.name"
                                                            ng-click="sever(owner, comp)">
                                                            {{ owner.name }}
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="message add">
                                                    <button class="auto-width" ng-click="backTooltip($event)">Back</button>
                                                    <h3>Choose Company</h3>
                                                    <div class="choose-all-companies">
                                                        <div class="company-decision" 
                                                            ng-repeat="newOwner in players[currentPlayer].companies 
                                                            | notDirectlyOwnedBy: comp | orderBy: subComp.name"
                                                            ng-click="addOwner(newOwner, comp)">
                                                            {{ newOwner.name }}
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="pointy"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </body>
    <script src="scripts/menu.js"></script>
</html>